@startuml
!include style.iuml

participant ":__ReservationController__" as rController
participant ":__ReservationMapper__" as rMapper
participant "r:__Reservation__" as reservation
participant ":__ReservationUoWAspect__" as UoW

[-> rController: modifyReservation(resID, description)
rController -> rMapper : find(resID)
ref over rMapper : Find Reservation
rMapper --> rController : r

alt sameTime && sameEquip
	rController -> rMapper : set(...)
	rMapper -> reservation : setDescription(description)

	rMapper -> UoW : registerDirty(r)

	rController -> rMapper : done()
	ref over rMapper : Complete Work
	rMapper --> rController : result
	[<-- rController : result
else sameTime && !sameEquip
	rController -> rController : showRequestForm(OGRoom, new)
	rController --> rController : temp1

	alt temp1 == null
		rMapper -> UoW : registerDirty(r)

		rController -> rMapper : done()
		ref over rMapper : Complete Work
		rMapper --> rController : result
		[<-- rController : result
	end
else else
	rController -> rController : showRequestForm(OGRoom, new)
	rController --> rController : temp1

	rController -> rController : requestReservation(OGRoom, new)
	rController --> rController : temp2

	alt temp1 == null && temp2 == null
		rMapper -> UoW : registerDirty(r)

		rController -> rMapper : done()
		ref over rMapper : Complete Work
		rMapper --> rController : result
		[<-- rController : result
	end
end
@enduml